---
title: "人の顔を入れ替えてみた！最新の顔すり替え手法 SimSwapの解説！" # 記事のタイトル
emoji: "😸" # アイキャッチとして使われる絵文字（1文字だけ）
type: "tech" # tech: 技術記事 / idea: アイデア記事
topics: ["機械学習"] # タグ。["markdown", "rust", "aws"]のように指定する
published: false # 公開設定（falseにすると下書き）
---

こんにちは、鷲崎です。昨今、精巧な偽画像を作成するディープフェイクによる事件が摘発され、実社会の驚異となってきています。例えば、動画の顔をすり替えることで、偽の演説動画を作成したフェイクニュースや、ポルノ動画に写った人物の顔をアイドルの顔にすり替えるフェイクポルノなどの事件は話題になったかと思います。

このように犯罪用途で何かと注目されるAIによる顔すり替え技術ですが、非常に有用な技術でもあります。例えば、テレビ番組や映画制作では亡くなった役者を登場させたり、スタントマンの顔をすり替えるなど制作の強化に使われています。また、洋服の試着では、体型や顔をすり替えることで、仮想的な試着を可能にします。博物館などで、歴史上の偉人をリアルな映像で登場させるなどの応用例もあります。

しかし、従来の顔すり替え技術では、対象の顔を目的の顔にすり替えるためにチューニングする必要があったり、すり替え対象の顔における表情や視線などの属性をすり替え後に保持できていないなどの課題がありました。そこで、本記事で紹介する[SimSwap: An Efficient Framework For High FidelityFace Swapping](https://arxiv.org/abs/2106.06340)という論文では、Simple Swap (SimSwap)と呼ばれる効率的で、任意の顔の属性を保持したまま、任意の目的の顔にすり替えるフレームワークが提案されました。

まず、実際に試して、下図のような結果が得られました。一番左の列がすり替え対象の顔画像で、一番上の行がすり替える目的の顔です。眼鏡をかけている私ですが、眼鏡のデータが少ないためか、顔すり替え後の画像の目の部分に違和感があります。他の方々の顔すり替えは上手くいっているようです。輪郭や表情、目線は保持しつつ、顔すり替えができています。

![](https://storage.googleapis.com/zenn-user-upload/442b2b05e6eb3b9010ad507b.png)

この後、すり替え対象となる顔(左側列）を対象の顔、すり替える目的の顔(一番上の行）をソースの顔と呼びます。

# SimSwapの立ち位置

顔すり替え手法には、画像レベルで対象の顔を扱うソース指向の手法と、特徴量レベルで対象の顔を扱う対象指向の手法があります。

ソース指向の手法は、表情や姿勢などの属性を対象の顔からソースの顔へ転写し、その後、転写されたソースの顔を対象の顔にブレンドするすることで顔をすり替えている。これらの手法は、ソース画像の姿勢や照明の影響を受けやすく、すり替え対象の表情を正確に再現することができないという欠点があります。

対象指向の手法は、対象画像の特徴を直接ソース画像に修正するので、ソースの顔のバリエーションに上手く対応できないという欠点があります。

他にもIDに特化した顔すり替え手法では、特定のID(ソース情報)に限定してすり替えを行うため汎化性にかけていたり、GANベースの手法ではソースの顔情報を残すため、対象画像の表情などの属性情報を保持できていない場合が多々あります。

そこで、論文の著者は、ID(ソース情報)に特化した顔すり替え手法のアーキテクチャを分析し、デコーダ部分にID情報が統合されているため汎化性が欠如していることを発見した。SimSwapでは、この統合を避けるためID注入モジュールを提案した。また、IDと属性の情報が特徴量レベルで結びついていており、特徴量レベルで変更した場合性能が劣化することから、それを緩和する弱特徴マッチング損失を提案した。

上記の手法を用いることで、SimSwapは、競争力のあるID(ソース情報）の転写性能を実現し、従来の手法より優れた属性保持能力を持つことができた。